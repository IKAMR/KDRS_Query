[XML_QUERY]

job_id=C01 
job_enabled=1 
job_name=Analyse_count_archives- Antall arkiv
job_description=

system=noark5 
subsystem= 
source= arkivstruktur.xml
target=noark5_analyse_{dt}.log

#START#
concat('Antall arkiv: ', count(//arkiv))
#STOP#

[XML_QUERY]

job_id=C02
job_enabled=1 
job_name=Antall arkivdel 
job_description=

system=noark5 
subsystem=
source=arkivstruktur.xml 
target=noark5_analyse_{dt}.log

#START# 
concat('Antall arkivdeler: ', count(//arkivdel)), //arkivdel/tittel/text()
#STOP#

[XML_QUERY]

job_id=C02.2
job_enabled=1 
job_name=Arkivdeler
job_description=

system=noark5 
subsystem=
source=arkivstruktur.xml 
target=noark5_analyse_{dt}.log

#START# 
concat('Antall arkiv: ', count(//arkiv), ' ', //arkiv/tittel)
#STOP#

[XML_QUERY]

job_id=C03
job_enabled=1 
job_name=Arkivdelens periode
job_description=

system=noark5 
subsystem= 
source=arkivstruktur.xml 
target=noark5_analyse_{dt}.log

#START# 
for $a in //arkivdel
return 
(concat('Arkivdel ' , $a/tittel, ': ') , sort(for $v in distinct-values($a//mappe/opprettetDato/substring-before(., "-"))
return
(concat($v,": ", count(index-of($a//mappe/opprettetDato/substring-before(., "-"), $v))))))

#STOP#

